/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*! matches.js v1.0.3 - Nicolas Gallagher - MIT license */

/*! delegate.js v1.0.2 - Nicolas Gallagher - MIT license */

/*!
 * xdm.js – Nicolas Gallagher – MIT License
 * easyXDM – Copyright(c) 2009-2011, Øyvind Sean Kinsey, oyvind@kinsey.no – MIT License
 */

/**
 * Copyright (c) 2013 Forbes Lindesay

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */

!function(){function t(t){var e=t.getAttribute("data-width"),n=t.getAttribute("data-height");return n/e}function e(){return document.querySelectorAll(".WEB-PLAYER, .WEB-VIDEO")}function n(){for(var n=e(),o=0,i=n.length;i>o;o++)!function(e){var n=e.children[0],o=t(n),i=window.getComputedStyle(e),r=parseInt(i.width),a=parseInt(i.height);r>a?e.style.height=o*r+"px":e.style.width=1/o*a+"px"}(n[o])}var o,i,r;!function(t){function e(t,e){return E.call(t,e)}function n(t,e){var n,o,i,r,a,s,c,u,l,p,d=e&&e.split("/"),f=v.map,h=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=d.concat(t.split("/")),u=0;u<t.length;u+=1)if(p=t[u],"."===p)t.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===t[2]||".."===t[0]))break;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||h)&&f){for(n=t.split("/"),u=n.length;u>0;u-=1){if(o=n.slice(0,u).join("/"),d)for(l=d.length;l>0;l-=1)if(i=f[d.slice(0,l).join("/")],i&&(i=i[o])){r=i,a=u;break}if(r)break;!s&&h&&h[o]&&(s=h[o],c=u)}!r&&s&&(r=s,a=c),r&&(n.splice(0,a,r),t=n.join("/"))}return t}function a(e,n){return function(){return f.apply(t,b.call(arguments,0).concat([e,n]))}}function s(t){return function(e){return n(e,t)}}function c(t){return function(e){g[t]=e}}function u(n){if(e(y,n)){var o=y[n];delete y[n],w[n]=!0,d.apply(t,o)}if(!e(g,n)&&!e(w,n))throw new Error("No "+n);return g[n]}function l(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function p(t){return function(){return v&&v.config&&v.config[t]||{}}}var d,f,h,m,g={},y={},v={},w={},E=Object.prototype.hasOwnProperty,b=[].slice;h=function(t,e){var o,i=l(t),r=i[0];return t=i[1],r&&(r=n(r,e),o=u(r)),r?t=o&&o.normalize?o.normalize(t,s(e)):n(t,e):(t=n(t,e),i=l(t),r=i[0],t=i[1],r&&(o=u(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:o}},m={require:function(t){return a(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:p(t)}}},d=function(n,o,i,r){var s,l,p,d,f,v,E=[];if(r=r||n,"function"==typeof i){for(o=!o.length&&i.length?["require","exports","module"]:o,f=0;f<o.length;f+=1)if(d=h(o[f],r),l=d.f,"require"===l)E[f]=m.require(n);else if("exports"===l)E[f]=m.exports(n),v=!0;else if("module"===l)s=E[f]=m.module(n);else if(e(g,l)||e(y,l)||e(w,l))E[f]=u(l);else{if(!d.p)throw new Error(n+" missing "+l);d.p.load(d.n,a(r,!0),c(l),{}),E[f]=g[l]}p=i.apply(g[n],E),n&&(s&&s.exports!==t&&s.exports!==g[n]?g[n]=s.exports:p===t&&v||(g[n]=p))}else n&&(g[n]=i)},o=i=f=function(e,n,o,i,r){return"string"==typeof e?m[e]?m[e](n):u(h(e,n).f):(e.splice||(v=e,n.splice?(e=n,n=o,o=null):e=t),n=n||function(){},"function"==typeof o&&(o=i,i=r),i?d(t,e,n,o):setTimeout(function(){d(t,e,n,o)},4),f)},f.config=function(t){return v=t,v.deps&&f(v.deps,v.callback),f},r=function(t,n,o){n.splice||(o=n,n=[]),e(g,t)||e(y,t)||(y[t]=[t,n,o])},r.amd={jQuery:!0}}(),r("almondLib",function(){}),r("unification/logger",["require","exports","module"],function(t,e,n){function o(t){return function(){if(window.DEBUG){var e=Array.prototype.slice.apply(arguments);e.unshift(t),console.log.apply(console,e)}}}n.exports=o}),r("common/utils",["require","exports","module","unification/logger"],function(t,e,n){var o=t("unification/logger")("[UTILS]"),i={getConfigFromJsonIn:function(t){var e,n=document.getElementById(t),i=null;if(!n)return o(["Element with id",t,"not found"].join(" ")),i;e=n.innerHTML;try{i=JSON.parse(e)}catch(r){o(["Error while parsing json in element",t].join(" "),r)}return i},isEmpty:function(t){return!i.isDefined(t)||"string"==typeof t&&0===t.length},isDefined:function(t){return"undefined"!=typeof t&&null!==t},isObject:function(t){return i.isDefined(t)&&"object"==typeof t},toArray:function(t){return Array.prototype.slice.call(t,0)},escapeHtml:function(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML},decodeHtml:function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes[0].nodeValue},trigger:function(t,e){var n=new Event(e);t.dispatchEvent(n)},getFollowElements:function(t){var e,n=t&&t.target;if(n){for(;!n.dataset.userId&&n.parentElement;)n=n.parentElement;return e=n.dataset.userId,i.fetchTargetElement("data-user-id",e)}return[]},fetchTargetElement:function(t,e){var n="*["+t+'="'+e+'"]';return i.toArray(document.querySelectorAll(n))},createUrl:function(t,e){var n=t;n+=-1!==n.indexOf("?")?"&":"?";for(var o in e)n=n+encodeURIComponent(o)+"="+encodeURIComponent(e[o])+"&";return n.substr(0,n.length-1)},getTarget:function(t){return t.target}};n.exports=i}),function(t){function e(t,e){var n,r,a=t.parentNode;if(a||i||(a=document.createDocumentFragment(),a.appendChild(t)),o)return o.call(t,e);for(n=a.querySelectorAll(e),r=n.length;r--;)if(n[r]===t)return!0;return!1}var n=Element.prototype,o=n.matches||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector,i=function(){return o?o.call(document.createElement("a"),"a"):!1}();"object"==typeof exports?module.exports=e:"function"==typeof r&&r.amd?r("matches",[],function(){return e}):t.matches=e}(this),function(t){function e(t){function e(t){if(!o(t))throw new Error("delegate(): The argument must be an Element or Document Node");return i=t,e}function n(e,n,o){for(;n&&n!==e;){if(t(n,o))return n;n=n.parentElement}return null}function o(t){return t&&t.nodeName&&(3===t.nodeType||9===t.nodeType)?!0:!1}var i;return e.on=function(t,o,r,a,s){function c(a){(a.delegateTarget=n(i,a.target,o))&&(s===!0&&e(i).off(t,c),r.call(i,a))}return r._delegateWrapper=c,i.addEventListener(t,c,a||!1),r},e.once=function(t,n,o,i){e.on(t,n,o,i,!0)},e.off=function(t,e,n){e._delegateWrapper&&(e=e._delegateWrapper),i.removeEventListener(t,e,n||!1)},e}"object"==typeof exports?module.exports=e(i("matches")):"function"==typeof r&&r.amd?r("delegate",["matches"],e):t.delegate=e(t.matches)}(this),function(t){function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function n(t){return"undefined"==typeof t}function o(e){return t.xdm=_,E=e,E&&(S="xdm_"+E.replace(".","_")+"_"),b}function i(t){if(!t)throw new Error("url is undefined or empty");if(/^file/.test(t))throw new Error("The file:// protocol is not supported");var e=t.toLowerCase().match(y);if(e){var n=e[2],o=e[3],i=e[4]||"";return("http:"===n&&":80"===i||"https:"===n&&":443"===i)&&(i=""),n+"//"+o+i}return t}function a(t){if(!t)throw new Error("url is undefined or empty");if(t=t.replace(w,"$1/"),!t.match(/^(http||https):\/\//)){var e="/"===t.substring(0,1)?"":location.pathname;"/"!==e.substring(e.length-1)&&(e=e.substring(0,e.lastIndexOf("/")+1)),t=location.protocol+"//"+location.host+e+t}for(;v.test(t);)t=t.replace(v,"");return t}function s(t,e){if(!e)throw new Error("parameters is undefined or null");var n=t.indexOf("#"),o=[];for(var i in e)e.hasOwnProperty(i)&&o.push(i+"="+encodeURIComponent(e[i]));return t+(-1===n?"#":"&")+o.join("&")}function c(t,e,n){var o;for(var i in e)e.hasOwnProperty(i)&&(i in t?(o=e[i],"object"==typeof o?c(t[i],o,n):n||(t[i]=e[i])):t[i]=e[i]);return t}function u(t){var e=h.cloneNode(!1);if(c(t.props,{frameBorder:0,allowTRansparency:!0,scrolling:"no",width:"100%",src:s(t.remote,{xdm_e:i(location.href),xdm_c:t.channel,xdm_p:1}),name:S+t.channel+"_provider",style:{margin:0,padding:0,border:0}}),e.id=t.props.name,delete t.props.name,!t.container)throw new Error('xdm.Rpc() configuration object missing a DOM "container" property');return c(e,t.props),t.container.appendChild(e),t.onLoad&&x(e,"load",t.onLoad),t.html&&(e.contentWindow.document.open(),e.contentWindow.document.write(t.html),e.contentWindow.document.close()),t.iframe=e,e}function l(t,e){"string"==typeof t&&(t=[t]);for(var n,o=t.length;o--;)if(n=t[o],n=new RegExp("^"===n.substr(0,1)?n:"^"+n.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),n.test(e))return!0;return!1}function p(t){var e;if(t.isHost=t.isHost||n(A.xdm_p),t.props=t.props||{},t.isHost)t.remote=a(t.remote),t.channel=t.channel||"default"+m++;else if(t.channel=A.xdm_c.replace(/["'<>\\]/g,""),t.remote=A.xdm_e.replace(/["'<>\\]/g,""),t.acl&&!l(t.acl,t.remote))throw new Error("Access denied for "+t.remote);return e=[new b.stack.PostMessageTransport(t)],e.push(new b.stack.QueueBehavior(!0)),e}function d(t){var e,n,o=t.length,i={incoming:function(t,e){this.up.incoming(t,e)},outgoing:function(t,e){this.down.outgoing(t,e)},callback:function(t){this.up.callback(t)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(n=0;o>n;n++)e=t[n],c(e,i,!0),0!==n&&(e.down=t[n-1]),n!==o-1&&(e.up=t[n+1]);return e}function f(t){t.up.down=t.down,t.down.up=t.up,t.up=t.down=null}var h=document.createElement("IFRAME"),m=Math.floor(1e4*Math.random()),g=Function.prototype,y=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,v=/[\-\w]+\/\.\.\//,w=/([^:])\/\//g,E="",b={},_=t.xdm,S="xdm_",A=function(t){t=t.substring(1,t.length).split("&");for(var e,n={},o=t.length;o--;)e=t[o].split("="),n[e[0]]=decodeURIComponent(e[1]);return n}(location.hash),x=function(){return t.addEventListener?function(t,e,n){t.addEventListener(e,n,!1)}:function(t,e,n){t.attachEvent("on"+e,n)}}(),O=function(){return t.removeEventListener?function(t,e,n){t.removeEventListener(e,n,!1)}:function(t,e,n){t.detachEvent("on"+e,n)}}();c(b,{version:"1.0.0",query:A,stack:{},noConflict:o}),b.Rpc=function(t,e){var n;if(e.local)for(var o in e.local)e.local.hasOwnProperty(o)&&(n=e.local[o],"function"==typeof n&&(e.local[o]={method:n}));var r=d(p(t).concat([new b.stack.RpcBehavior(this,e),{callback:function(e){t.onReady&&t.onReady(e)}}]));this.origin=i(t.remote),this.destroy=function(){r.destroy()},r.init(),this.iframe=t.iframe},b.stack.PostMessageTransport=function(e){function n(t){var n=i(t.origin),r="string"==typeof t.data;n===s&&r&&t.data.substring(0,e.channel.length+1)===e.channel+" "&&o.up.incoming(t.data.substring(e.channel.length+1),n)}var o,r,a,s;return o={outgoing:function(t,n,o){a.postMessage(e.channel+" "+t,n||s),o&&o()},destroy:function(){O(t,"message",n),r&&(a=null,r.parentNode.removeChild(r),r=null)},init:function(){if(s=i(e.remote),e.isHost){var c=function(i){i.data===e.channel+"-ready"&&(a="postMessage"in r.contentWindow?r.contentWindow:r.contentWindow.document,O(t,"message",c),x(t,"message",n),setTimeout(function(){o.up.callback(!0)},0))};x(t,"message",c),r=u(e)}else x(t,"message",n),a="postMessage"in t.parent?t.parent:t.parent.document,a.postMessage(e.channel+"-ready",s),setTimeout(function(){o.up.callback(!0)},0)}}},b.stack.QueueBehavior=function(t){function e(){var a;return t===!0&&0===i.length?void f(n):void(r||0===i.length||o||(r=!0,a=i.shift(),n.down.outgoing(a.data,a.origin,function(t){r=!1,a.callback&&setTimeout(function(){a.callback(t)},0),e()})))}var n,o,i=[],r=!0;return n={init:function(){n.down.init()},callback:function(t){r=!1;var o=n.up;e(),o.callback(t)},incoming:function(t,e){n.up.incoming(t,e)},outgoing:function(t,n,o){i.push({data:t,origin:n,callback:o}),e()},destroy:function(){o=!0,n.down.destroy()}}},b.stack.RpcBehavior=function(t,o){function i(t){t.jsonrpc="2.0",s.down.outgoing(JSON.stringify(t))}function r(t,e){var n=Array.prototype.slice;return function(){var o,r=arguments.length,a={method:e};r>0&&"function"==typeof arguments[r-1]?(r>1&&"function"==typeof arguments[r-2]?(o={success:arguments[r-2],error:arguments[r-1]},a.params=n.call(arguments,0,r-2)):(o={success:arguments[r-1]},a.params=n.call(arguments,0,r-1)),u[""+ ++c]=o,a.id=c):a.params=n.call(arguments,0),t.namedParams&&1===a.params.length&&(a.params=a.params[0]),i(a)}}function a(t,o,r,a){if(!r)return void(o&&i({id:o,error:{code:-32601,message:"Procedure not found."}}));var s,c;o?(s=function(t){s=g,i({id:o,result:t})},c=function(t,e){c=g;var n={id:o,error:{code:-32099,message:t}};e&&(n.error.data=e),i(n)}):s=c=g,e(a)||(a=[a]);try{var u=r.method.apply(r.scope,a.concat([s,c]));n(u)||s(u)}catch(l){c(l.message)}}var s,c=0,u={};return s={incoming:function(t){var e,n=JSON.parse(t);n.method?o.handle?o.handle(n,i):a(n.method,n.id,o.local[n.method],n.params):(e=u[n.id],n.error&&e.error?e.error(n.error):e.success&&e.success(n.result),delete u[n.id])},init:function(){if(o.remote)for(var e in o.remote)o.remote.hasOwnProperty(e)&&(t[e]=r(o.remote[e],e));s.down.init()},destroy:function(){for(var e in o.remote)o.remote.hasOwnProperty(e)&&t.hasOwnProperty(e)&&delete t[e];s.down.destroy()}}},"object"==typeof exports?module.exports=b:"function"==typeof provide?provide(b):"function"==typeof r&&r.amd?r("xdm",[],function(){return b}):t.xdm=b}(window),r("common/video-interface-manager",["require","exports","module","delegate","xdm","common/utils"],function(t,e,n){function o(){var t=l.getConfigFromJsonIn("video-config"),e="";return"undefined"!=typeof t&&null!==t&&(e=l.createUrl(t.video_player_url,t.params)),e}function i(){return document.querySelectorAll(".VideoContainer")}function r(){var t=document.getElementById("ExternalIframeContainer");return t&&t.className.match(/\bAmplifyContainer\b/)?t:void 0}function a(t,e,n){var o=new u.Rpc({remote:e,container:t,isHost:!0},{local:{callVideoHostMethod:n.callVideoHostMethod.bind(n)}});return o.iframe.setAttribute("allowfullscreen",""),o}function s(t){for(var e,n,r,s,c=i(),u=0;u<c.length;u++)e=c[u],n={vmap_url:e.getAttribute("data-src"),image_src:e.getAttribute("data-thumbnail"),content_id:e.getAttribute("data-content-id"),type:e.getAttribute("data-type")},s=l.createUrl(o(),n),r=a(e,s,t),t.attachVideoInterface(r)}function c(t){var e,n,o=r();o&&(e=o.getAttribute("data-player-url"),n=a(o,e,t),t.attachVideoInterface(n))}var u=(t("delegate"),t("xdm")),l=t("common/utils"),p={init:function(t){s(t),c(t)},isSupported:function(){var t=i(),e=r();return t.length>0||"undefined"!=typeof e}};n.exports=p}),r("unification/config",["require","exports","module"],function(t,e,n){var o={eventToTcmlActionAttr:{click:"tap_action_id",mouseover:"press_down_action_id",mouseout:"press_up_action_id",load:"load_action_id"},protobufToAttribute:{binding_key:"data-bindings"},apiWhitelist:[/^https:\/\/ads.twitter.com(?:\/.*)?$/,/^https:\/\/cards.twitter.com\/cards(?:\/.*)?$/,/^https:\/\/cards-staging.twitter.com\/cards(?:\/.*)?/,/https:\/\/cards-beta.twitter.com\/cards(?:\/.*)?/,/^http(s)?:\/\/caps.twitter.com(?:\/.*)?/,/^http(s)?:\/\/caps-devel.twitter.com(?:\/.*)?/,/^http(s)?:\/\/caps-staging.twitter.com(?:\/.*)?/,/^http(s)?:\/\/127.0.0.1(?:\/.*)?/,/^http(s)?:\/\/localhost(?:\/.*)?/]};n.exports=o}),r("unification/bindings/destinations",["require","exports","module","common/utils","unification/logger"],function(t,e,n){var o=(t("common/utils"),t("unification/logger")("[DESTINATIONS]")),i={content_type:function(){throw Error("Not sure how to handle content_type")},display_url:function(t,e){t.innerText=e},id:function(){throw Error("Not sure how to handle id")},image:function(t,e){var n={url:"src",width:"width",height:"height"},o=function(t){Object.keys(e).forEach(function(o){var i=n[o];if("string"!=typeof i)throw new Error(["Not sure how to handle value",o,"for image"].join(" "));t.setAttribute(i,e[o])})};"img"===t.tagName.toLowerCase()?o(t):(t.style.backgroundImage="url("+e.url+")",o(t.children[0]))},phone_number:function(){o("dest phone_number not supported on web")},phone_number_url:function(){o("dest phone_number_url not supported on web")},stream_height:function(t,e){t.setAttribute("height",e)},stream_url:function(t,e){t.setAttribute("src",e)},stream_width:function(t,e){t.setAttribute("width",e)},text:function(t,e){t.textContent=e},url:function(t,e){t.setAttribute("href",e)},follow_state:function(t,e){t.classList.add(e)},visible:function(t,e){var n=e?"":"none";t.style.display=n}};n.exports={getHandler:function(t){var e=t;return i.hasOwnProperty(e)||(o(['Dest type"',e,'"not supported. Default to "text"'].join(" ")),e="text"),i[e]}}}),r("unification/bindings/controllers",["require","exports","module","unification/logger"],function(t,e,n){var o=t("unification/logger")("[CONTROLLERS]"),i={"true":function(){return!0},"false":function(){return!1},exist:function(t){return void 0!==typeof t&&null!==t},identity:function(t){return t},setFollowStatus:function(t){return t.following===!0?"following":t.blocking===!0?"blocked":"not-following"}};n.exports={getHandler:function(t){var e=t;return i.hasOwnProperty(e)||(e="identity",o(["Controller type",t,"not found. Return identity function instead"].join(" "))),i[e]}}}),r("unification/bindings/Binding",["require","exports","module","unification/config","./destinations","./controllers","common/utils","unification/logger"],function(t,e,n){function o(t,e){d(t);var n=t.controller,o=t.destination,s=function(t){return function(e,n){a(e.options,t,n)}};this.boundTo=e,this.key=t.key,this.snakeCasedKey=this.key.replace(/(stringValue|imageValue|userValue)/g,function(t){return c(t)}),"action"===t.controller?(this.destination=s(o),this.hasController=!1):(this.destination=u.getHandler(o),this.hasController="string"==typeof t.controller&&t.controller.length>0),this.hasController?(this.controller=l.getHandler(n),this.shouldNegateController=t.negate&&"true"===t.negate.toString(),this.transform=r):this.transform=i}function i(t){return t}function r(t){return t=this.controller(t),this.shouldNegateController&&(t=!t),t}function a(t,e,n){var o=e.split("."),i=t;o.forEach(function(t,e){var r=e===o.length-1;if(Array.isArray(i))try{t=parseInt(t)}catch(a){return void d("Error parsing key to Number",a)}r?i[t]=n:i=i[t]})}function s(t,e){var n=e;return t.forEach(function(t){n="object"==typeof n&&null!=n&&"undefined"!=typeof n[t]?n[t]:null}),n}function c(t){return t.replace(/([A-Z])/g,function(t,e){return"_"+e.toLowerCase()})}n.exports=o;var u=(t("unification/config"),t("./destinations")),l=t("./controllers"),p=t("common/utils"),d=t("unification/logger")("[BINDING]");o.prototype.resolveValue=function(t){var e=this.key.split("."),n=s(e,t);return null===n&&(n=s(this.snakeCasedKey.split("."),t)),n},o.prototype.apply=function(t){var e;if(!p.isDefined(t))return void d("bindingValues is not defined");try{e=this.transform(this.resolveValue(t)),d("Applying",e,"to",this.destination,t),this.destination(this.boundTo,e)}catch(n){d("Error applying binding for: ",this.key)}}}),r("unification/bindings/registry",["require","exports","module","unification/logger","unification/config","./Binding"],function(t,e,n){function o(t){if("object"!=typeof t)throw new Error("bindingValues undefined");var e=g.getAllElementsWithBindings();m.flush(),e.forEach(function(e){var n=g.getBindingConfigs(e);return Array.isArray(n)?(n.forEach(function(n){i(n,e,t)}),void d(m)):void console.error("binding config needs to be an array")})}function i(t,e,n){var o=new h(t,e);o.hasController&&o.apply(n),d("key",o.key,o.snakeCasedKey),m.add(o.snakeCasedKey,o),m.add(o.key,o)}function r(t){var e=function(e){var n=e.join("."),o=m.get(n);d("retrieving binding for",n),o.forEach(function(e){d("reapply bindings",e),e.apply(t)})};c([],t,e)}function a(){return!1}function s(){return!1}function c(t,e,n,o){return null!==e?u(e)?void("function"==typeof o&&o(t,e)):void Object.keys(e).forEach(function(i){var r=t.slice(0);r.push(i),"function"==typeof n&&n(r,e),c(r,e[i],n,o)}):void 0}function u(t){var e=["string","boolean","number"];return e.indexOf(typeof t)>-1}function l(){this.map={},this.add=function(t,e){this.map.hasOwnProperty(t)||(this.map[t]=[]),this.map[t].push(e)},this.get=function(t){return this.map.hasOwnProperty(t)?this.map[t]:[]},this.flush=function(){this.map={}}}n.exports={init:o,reapplyBindings:r,addBinding:i,noBindings:a,badBindings:s};var p=t("unification/logger"),d=p("[BINDINGS REGISTRY]"),f=t("unification/config"),h=t("./Binding"),m=new l,g={getAllElementsWithSelector:function(t){var e=document.querySelectorAll(t);return Array.prototype.slice.apply(e)},getAllElementsWithAttribute:function(t){var e="*["+t+"]";return g.getAllElementsWithSelector(e)},getAllElementsWithBindings:function(){return g.getAllElementsWithAttribute(f.protobufToAttribute.binding_key)},getBindingConfigs:function(t){var e=t.getAttribute(f.protobufToAttribute.binding_key),n=null;if("string"==typeof e)try{n=JSON.parse(e)}catch(o){d("binding is not json")}return n}}}),r("common/throttle",["require","exports","module"],function(t,e,n){n.exports=function(t,e){var n,o,i,r,a=0,s=function(){a=new Date,i=null,r=t.apply(n,o)};return function(){var c=new Date,u=e-(c-a);return n=this,o=arguments,0>=u?(clearTimeout(i),i=null,a=c,r=t.apply(n,o)):i||(i=setTimeout(s,u)),r}}}),r("unification/bridge",["require","exports","module","unification/logger","xdm","common/throttle","common/utils"],function(t,e,n){function o(){h=new p.Rpc({onReady:function(){r(),h.localMethodNames(function(t){m=t}),l("xdm bridge ready on client")}},{local:{localMethodNames:function(){return{callVideoPlayerMethod:!0}},callVideoPlayerMethod:s},remote:{callMethodByName:{},cancelUserFollow:{},localMethodNames:{},favoriteStatus:{},followUser:{},openLink:{},openPhoto:{},openProfile:{},resizeCard:{},retweetStatus:{},shareStatus:{},statusComposeTweet:{},unfollowUser:{},unblockUser:{},scribe:{}}})}function i(){return null===h&&o(),h}function r(){var t=u(h),e=d(function(){t()},75),n=document.querySelectorAll("img");f.toArray(n).forEach(function(t){t.addEventListener("load",e)}),["resize","load","DOMSubtreeModified","js-resize"].forEach(function(t){window.addEventListener(t,e,!1)}),e()}function a(t){g.push(t)}function s(){g.forEach(function(t){t.callMethodByName.apply(t,arguments)})}function c(){return m.callMethodByName?h.callMethodByName.apply(h,arguments):void 0}function u(){var t=0,e=document.getElementById("Container");return e?function(){var n=e.offsetHeight;n!==t&&(h.resizeCard({height:n+"px"}),t=n)}:void console.warn("Element with id Container not found")}n.exports={get:i,initAndResizeHost:o,attachVideoInterface:a,callVideoHostMethod:c};var l=t("unification/logger")("[BRIDGE]"),p=t("xdm"),d=t("common/throttle"),f=t("common/utils"),h=null,m=null,g=[]}),r("unification/actions/handlers",["require","exports","module"],function(t,e,n){function o(t,e){var n=i[t];if(!n)throw new Error(["Action with id",t,"not found in registry"].join(" "));n.performAction(e)}var i={};n.exports={performActionWithId:o,registry:i}}),r("unification/actions/BaseAction",["require","exports","module","unification/bindings/registry","unification/bridge","unification/logger","./handlers","common/utils"],function(t,e,n){function o(t,e){var n,o=this;o.verifyOptions(t),o.options=t,o.host=e||r.get(),o.triggeredDomEvent=null,o.options.bindings&&o.options.bindings.forEach(function(t){i.addBinding(t,o)}),n=u.getConfigFromJsonIn("scribe-config"),o.scribeData=n?n.scribeData:null,o.performAction=function(t){t&&o.setTriggeredDomEvent(t);try{s(o.options.id+": performing",o.options),o.actionHandler(),o.signalSuccess(),o.doCustomScribeIfNeeded()}catch(e){s(e.message,e.stack),o.signalFailure()}}.bind(o)}n.exports=o;var i=t("unification/bindings/registry"),r=t("unification/bridge"),a=t("unification/logger"),s=a("[ACTION BASE]"),c=t("./handlers"),u=t("common/utils");o.prototype.schema={id:"",action_type:""},o.prototype.signalSuccess=function(){var t=this.createHandler(this.options.success_action_id);t(),this.setTriggeredDomEvent(null),s(this.options.id+": Signal success")},o.prototype.signalFailure=function(){var t=this.createHandler(this.options.failure_action_id);t(),this.setTriggeredDomEvent(null),s(this.options.id+": Signal failure")},o.prototype.verifyOptions=function(t){Object.keys(this.schema).forEach(function(e){if(!t.hasOwnProperty(e))throw console.dir(t),new Error("Options invalid. Required key: "+e+" not found")})},o.prototype.actionHandler=function(){throw new Error("Child object needs to implement method actionHandler")},o.prototype.getTriggeredDomEvent=function(){return this.triggeredDomEvent},o.prototype.setTriggeredDomEvent=function(t){this.triggeredDomEvent=t},o.prototype.createHandler=function(t){return t&&0!==t.length?function(){c.performActionWithId(t)}:function(){}},o.prototype.doCustomScribeIfNeeded=function(){var t,e,n,o;t=null,e=null,this.options.hasOwnProperty("scribe_element")&&(t=this.options.scribe_element),this.options.hasOwnProperty("scribe_action")&&(e=this.options.scribe_action),n=u.isDefined(t)||u.isDefined(e),n&&(o={customScribe:{element:t,action:e},scribeData:this.scribeData},this.host.scribe(o))}}),r("ajax",["require","exports","module"],function(t,e,n){function o(){return!0}function i(t,e,n,i){return t.global?o(e||_,n,i):void 0}function r(t){t.global&&0===R.active++&&i(t,null,"ajaxStart")}function a(t){t.global&&!--R.active&&i(t,null,"ajaxStop")}function s(t,e){var n=e.context;return e.beforeSend.call(n,t,e)===!1||i(e,n,"ajaxBeforeSend",[t,e])===!1?!1:void i(e,n,"ajaxSend",[t,e])}function c(t,e,n){var o=n.context,r="success";n.success.call(o,t,r,e),i(n,o,"ajaxSuccess",[e,n,t]),l(r,e,n)}function u(t,e,n,o){var r=o.context;o.error.call(r,n,e,t),i(o,r,"ajaxError",[n,o,t]),l(e,n,o)}function l(t,e,n){var o=n.context;n.complete.call(o,e,t),i(n,o,"ajaxComplete",[e,n]),a(n)}function p(){}function d(t){return t&&(t==O?"html":t==x?"json":S.test(t)?"script":A.test(t)&&"xml")||"text"}function f(t,e){return(t+"&"+e).replace(/[&?]{1,2}/,"?")}function h(t){"object"===E(t.data)&&(t.data=g(t.data)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=f(t.url,t.data))}function m(t,e,n,o){var i="array"===E(e);for(var r in e){var a=e[r];o&&(r=n?o:o+"["+(i?"":r)+"]"),!o&&i?t.add(a.name,a.value):(n?"array"===E(a):"object"===E(a))?m(t,a,n,r):t.add(r,a)}}function g(t,e){var n=[];return n.add=function(t,e){this.push(L(t)+"="+L(e))},m(n,t,e),n.join("&").replace("%20","+")}function y(t){var e=Array.prototype.slice;return e.call(arguments,1).forEach(function(e){for(v in e)void 0!==e[v]&&(t[v]=e[v])}),t}var v,w,E=function(t){return Array.isArray(t)?"array":typeof t},b=0,_=window.document,S=/^(?:text|application)\/javascript/i,A=/^(?:text|application)\/xml/i,x="application/json",O="text/html",T=/^\s*$/,R=function(t){var e=y({},t||{});for(v in R.settings)void 0===e[v]&&(e[v]=R.settings[v]);r(e),e.crossDomain||(e.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(e.url)&&RegExp.$2!=window.location.host);var n=e.dataType,o=/=\?/.test(e.url);if("jsonp"==n||o)return o||(e.url=f(e.url,"callback=?")),R.JSONP(e);e.url||(e.url=window.location.toString()),h(e);var i,a=e.accepts[n],l={},m=/^([\w-]+:)\/\//.test(e.url)?RegExp.$1:window.location.protocol,g=R.settings.xhr();e.crossDomain||(l["X-Requested-With"]="XMLHttpRequest"),a&&(l.Accept=a,a.indexOf(",")>-1&&(a=a.split(",",2)[0]),g.overrideMimeType&&g.overrideMimeType(a)),(e.contentType||e.data&&"GET"!=e.type.toUpperCase())&&(l["Content-Type"]=e.contentType||"application/x-www-form-urlencoded"),e.headers=y(l,e.headers||{}),g.onreadystatechange=function(){if(4==g.readyState){clearTimeout(i);var t,o=!1;if(g.status>=200&&g.status<300||304==g.status||0==g.status&&"file:"==m){n=n||d(g.getResponseHeader("content-type")),t=g.responseText;try{"script"==n?(1,eval)(t):"xml"==n?t=g.responseXML:"json"==n&&(t=T.test(t)?null:JSON.parse(t))}catch(r){o=r}o?u(o,"parsererror",g,e):c(t,g,e)}else u(null,"error",g,e)}};var E="async"in e?e.async:!0;g.open(e.type,e.url,E);for(w in e.headers)g.setRequestHeader(w,e.headers[w]);return s(g,e)===!1?(g.abort(),!1):(e.timeout>0&&(i=setTimeout(function(){g.onreadystatechange=p,g.abort(),u(null,"timeout",g,e)},e.timeout)),g.withCredentials=!0,g.send(e.data?e.data:null),g)};R.active=0,R.JSONP=function(t){if(!("type"in t))return R(t);var e,n="jsonp"+ ++b,o=_.createElement("script"),i=function(){n in window&&(window[n]=p),l("abort",r,t)},r={abort:i},a=_.getElementsByTagName("head")[0]||_.documentElement;return t.error&&(o.onerror=function(){r.abort(),t.error()}),window[n]=function(o){clearTimeout(e),delete window[n],c(o,r,t)},h(t),o.src=t.url.replace(/=\?/,"="+n),a.insertBefore(o,a.firstChild),t.timeout>0&&(e=setTimeout(function(){r.abort(),l("timeout",r,t)},t.timeout)),r},R.settings={type:"GET",beforeSend:p,success:p,error:p,complete:p,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:x,xml:"application/xml, text/xml",html:O,text:"text/plain"},crossDomain:!1,timeout:0},R.get=function(t,e){return R({url:t,success:e})},R.post=function(t,e,n,o){return"function"===E(e)&&(o=o||n,n=e,e=null),R({type:"POST",url:t,data:e,success:n,dataType:o})},R.getJSON=function(t,e){return R({url:t,success:e,dataType:"json"})};var L=encodeURIComponent;n.exports=R}),r("unification/actions/ApiRequest",["require","exports","module","./BaseAction","unification/bindings/registry","ajax","unification/config","unification/logger","common/utils"],function(t,e,n){function o(t,e,n){this.schema={id:"",action_type:"API_REQUEST",api_request:{request_success_action_id:"",request_failure_action_id:"",method:"GET",api_url:"{{api_url}}",parameters:[{id:"",key:"message",value:"Echo-ing is all I do"},{id:"",key:"{{key}}",value:"{{value}}"}]}},this.checkWhitelist(e||c.apiWhitelist,t.api_request.api_url),this.inFlightRequests=p,this.actionHandler=function(){u("Handled in action",this.options.id),i.call(this,this.options.api_request)};var o=this.createHandler(t.api_request.request_success_action_id),a=this.createHandler(t.api_request.request_failure_action_id);this.onRequestSuccess=function(){u("Api request succeeded"),o()},this.onRequestFailure=function(){u("Api request failed"),a()},r.call(this,t,n)}function i(t){var e,n=this;if(n.isAnyRequestInFlight())throw u("Cancelled because another request is in flight: ",this.inFlightRequests[0].options.id),new Error("Another request in flight");e={type:t.method,url:l.decodeHtml(t.api_url),data:n.buildApiParameters(t),accepts:{},headers:{},contentType:"",beforeSend:function(){u([t.method,t.api_url].join(" "))},complete:this.complete.bind(this),timeout:5e3},n._request=s(e),n.setRequestInFlight()}n.exports=o;var r=t("./BaseAction"),a=t("unification/bindings/registry"),s=t("ajax"),c=t("unification/config"),u=t("unification/logger")("[API CALL]"),l=t("common/utils"),p=[];o.prototype=Object.create(r.prototype),o.prototype.checkWhitelist=function(t,e){var n,o=!1;for(n=0;n<t.length;n++)if(t[n].test(e)){o=!0;break}if(!o)throw new Error("Url "+e+" not whitelisted");return o},o.prototype.complete=function(t,e){var n=parseInt(t.status);this.unsetRequestInFlight(),"timeout"===e?this.handleTimeout(t):"error"===e||n>=400?this.handleError(t):n>=300?this.handleRedirect(t):204===n?this.handleNoContent(t):200===n&&this.handleOk(t),u("Api request completed",t,e)},o.prototype.handleOk=function(t){var e=this.parse(t.responseText),n=this,o={noData:function(t){u("200 - No data"),n.onRequestSuccess(t)},nonJson:function(t){u("200 - Non-JSON"),n.onRequestFailure(t)},jsonNoBindings:function(t){u("200 - JSON no bindings"),n.onRequestFailure(t)},jsonBadBindings:function(){u("200 - bad bindings"),n.onRequestFailure()},jsonValidBindings:function(t){u("200 -valid bindings"),n.reapplyBindings(t),n.onRequestSuccess(t)}};o[e.type](e.data)},o.prototype.handleNoContent=function(){this.onRequestSuccess()},o.prototype.handleError=function(t){var e=this.parse(t.responseText);"jsonValidBindings"===e.type&&this.reapplyBindings(e.data),this.onRequestFailure()},o.prototype.handleRedirect=function(){},o.prototype.handleTimeout=function(){u("Api request timed out"),this.abortRequest(),this.onRequestFailure()},o.prototype.reapplyBindings=function(t){a.reapplyBindings({BINDINGS:t})},o.prototype.noBindings=a.noBindings.bind(a),o.prototype.badBindings=a.badBindings.bind(a),o.prototype.buildApiParameters=function(t){var e=this,n=t.parameters,o={};return Array.isArray(n)&&n.forEach(function(t){t.hasOwnProperty("key")&&(o[t.key]=t.value)}),e.buildApiProxyData(t,o),o},o.prototype.buildApiProxyData=function(t,e){var n=l.getConfigFromJsonIn("scribe-config"),o=n&&n.scribeData,i=function(t,e,n){l.isDefined(t)&&(e[n]=t)};return i(t.api_proxy_rule,e,"__api_proxy_rule"),o&&(i(o.tweet_id,e,"__tweet_id"),i(o.card_name,e,"__card_name"),i(o.platform_key,e,"__platform_key")),e},o.prototype.sanitizeOptions=function(t){return t},o.prototype.isAnyRequestInFlight=function(){return this.inFlightRequests.length>0
},o.prototype.setRequestInFlight=function(){if(this.inFlightRequests.length>0)throw new Error("More than one request in flight. Something must be wrong.");this.inFlightRequests.push(this.options.id)},o.prototype.unsetRequestInFlight=function(){this.isAnyRequestInFlight()&&this.inFlightRequests.pop()},o.prototype.abortRequest=function(){this._request.abort&&this._request.abort(),this.cleanup()},o.prototype.cleanup=function(){this.unsetRequestInFlight()},o.prototype.parse=function(t){u("parsing",t);var e={type:"noData",data:null};if(!l.isEmpty(t))try{e.data=JSON.parse(t),e.type=this.noBindings(e.data)?"jsonNoBindings":this.badBindings(e.data)?"jsonBadBindings":"jsonValidBindings"}catch(n){u("JSON parsing error",n.message),e.type="nonJson"}return e}}),r("unification/actions/BaseStyleAction",["require","exports","module","./BaseAction","unification/logger","common/utils"],function(t,e,n){function o(t,e){this.schema={id:"",action_type:"REMOVE_STYLES|APPLY_STYLES",style_pairs:[{element_id:"",style_id:""}]},this.actionHandler=function(){this.processStylePairs(t.style_pairs)},r.call(this,t,e)}function i(t,e,n){s.isObject(e)&&Object.keys(e).forEach(function(o){var i=e[o];n(t,o,i)})}n.exports=o;var r=t("./BaseAction"),a=t("unification/logger"),s=t("common/utils"),c=(a("[BASE STYLE ACTION]"),null);o.prototype=Object.create(r.prototype),o.prototype.processStylePairs=function(t){var e=this;t.forEach(function(t){var n=document.getElementById(e.utils.resolveElementId(t.element_id)),o=e.utils.getStylesConfig()[t.style_id];i(n,o.standard,e.processStandardStyle.bind(e)),i(n,o.special,e.processSpecialStyle.bind(e)),Array.isArray(o.cssClasses)&&o.cssClasses.forEach(function(t){e.processCssClass(n,t)})})},o.prototype.processStandardStyle=function(){throw new Error("Child object needs to implement method processStandardStyle")},o.prototype.processSpecialStyle=function(){throw new Error("Child object needs to implement method processSpecialStyle")},o.prototype.processCssClass=function(){throw new Error("Child object needs to implement method proessCssClasses")},o.prototype.utils={getStylesConfig:function(){return c||(c=s.getConfigFromJsonIn("styles-config")),c},resolveElementId:function(t){return t},resolveClassName:function(t){return t},getStylesOfCssClass:function(t){var e,n=document.styleSheets[0],o=n.cssRules,i="."+t,r=[],a=Array.prototype.filter.call(o,function(t){return t.selectorText===i});if(a.length<1)throw Error(["No cssRule for",t].join(" "));for(a=a[0],e=0;e<a.style.length;e++)!function(t,e){var n=t.item(e),o=t.getPropertyValue(n);r.push({name:n,value:o})}(a.style,e);return r}}}),r("unification/actions/ApplyStyles",["require","exports","module","./BaseStyleAction","unification/logger","common/utils"],function(t,e,n){function o(t,e){this.schema={id:"",action_type:"APPLY_STYLES",style_pairs:[{element_id:"",style_id:""}]},i.call(this,t,e)}n.exports=o;var i=t("./BaseStyleAction"),r=t("unification/logger"),a=t("common/utils"),s=r("[APPLY STYLES]");o.prototype=Object.create(i.prototype),o.prototype.processStandardStyle=function(t,e,n){t.style.setProperty(e,n)},o.prototype.processSpecialStyle=function(t,e,n){return this.specialStyleHandlers.hasOwnProperty(e)?void this.specialStyleHandlers[e](t,n):void s("Don't know how to handle",e)},o.prototype.processCssClass=function(t,e){t.classList.add(e)},o.prototype.specialStyleHandlers={"visible-child-index":function(t,e){var n=parseInt(e),o=0,i=t.children.length;for(n>=0&&i>n&&t.children.item(n).classList.remove("hidden");i>o;o++){var r=t.children.item(o);o!==n&&r.classList.add("hidden")}a.trigger(window,"js-resize")}}}),r("unification/actions/RemoveStyles",["require","exports","module","./BaseStyleAction","unification/logger","common/utils"],function(t,e,n){function o(t,e){this.schema={id:"",action_type:"REMOVE_STYLES",style_pairs:[{element_id:"",style_id:""}]},i.call(this,t,e)}n.exports=o;var i=t("./BaseStyleAction"),r=t("unification/logger"),a=t("common/utils"),s=r("[REMOVE STYLES]");o.prototype=Object.create(i.prototype),o.prototype.processStandardStyle=function(t,e){t.style.removeProperty(e)},o.prototype.processSpecialStyle=function(t,e,n){return this.specialStyleHandlers.hasOwnProperty(e)?void this.specialStyleHandlers[e](t,n):void s("Don't know how to handle",e)},o.prototype.processCssClass=function(t,e){t.classList.remove(e)},o.prototype.specialStyleHandlers={"visible-child-index":function(t){a.toArray(t.children).forEach(function(t){t.classList.remove("hidden")})}}}),r("unification/actions/BaseRpcAction",["require","exports","module","./BaseAction","unification/logger","common/utils","xdm"],function(t,e,n){function o(t,e){this.schema={id:"",action_type:["CANCEL_FOLLOW_USER","FAVORITE_STATUS","FOLLOW_USER","RETWEET_STATUS","SHARE STATUS","UNBLOCK_USER","UNFOLLOW_USER","OPEN_URL","COMPOSE_STATUS","OPEN_PHOTO","OPEN_PROFILE","OPEN_STORE","OPEN_APP_URL","OPEN_URL_POPUP_MENU"]},this.actionType=t.action_type,this.actionHandler=this.newActionHandler,i.call(this,t,e)}n.exports=o;var i=t("./BaseAction"),r=t("unification/logger"),a=(t("common/utils"),t("xdm"),r("[REMOTE ACTION]"),{CANCEL_FOLLOW_USER:"cancelFollowUser",COMPOSE_STATUS:"statusComposeTweet",FAVORITE_STATUS:"favoriteStatus",FOLLOW_USER:"followUser",OPEN_URL:"openLink",OPEN_PHOTO:"openPhoto",OPEN_PROFILE:"openProfile",RETWEET_STATUS:"retweetStatus",SHARE_STATUS:"shareStatus",UNBLOCK_USER:"unblockUser",UNFOLLOW_USER:"unfollowUser"});o.prototype=Object.create(i.prototype),o.prototype.extractData=function(){return{}},o.prototype.newActionHandler=function(){var t,e=a[this.actionType];if(!e)throw new Error(["Method",this.actionType,"not found in map"].join(" "));if(!this.host.hasOwnProperty(e))throw new Error(["Method",this.actionType,"not found on host"].join(" "));t=this.extractData(),null!==this.scribeData&&(t.scribeData=this.scribeData),this.host[e](t)}}),r("unification/actions/ComposeStatus",["require","exports","module","common/utils","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"COMPOSE_STATUS"},r.apply(this,arguments)}n.exports=o;var i=t("common/utils"),r=t("./BaseRpcAction");o.prototype=Object.create(r.prototype),o.prototype.extractData=function(){var t=this.options.status_string;return Array.isArray(t)&&(t=t.join("")),{tweetText:i.decodeHtml(t)}}}),r("unification/actions/FavoriteStatus",["require","exports","module","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"FAVORITE_STATUS"},i.apply(this,arguments)}n.exports=o;var i=t("./BaseRpcAction");o.prototype=Object.create(i.prototype)}),r("unification/actions/OpenPhoto",["require","exports","module","unification/config","common/utils","unification/logger","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"OPEN_PHOTO"},s.apply(this,arguments)}n.exports=o;var i=t("unification/config"),r=t("common/utils"),a=t("unification/logger")("[OPEN PHOTO]"),s=t("./BaseRpcAction");o.prototype=Object.create(s.prototype),o.prototype.extractData=function(){var t={photos:[]},e=r.getTarget(this.getTriggeredDomEvent()),n="data-"+i.eventToTcmlActionAttr.click,o=r.fetchTargetElement(n,this.options.id);return o.forEach(function(n){var o=n.querySelectorAll("img").item(0);if(o){var i=o.getAttribute("src");t.photos.push({imageUrl:i,wasClicked:n===e})}else a("No img tag in Image element")}),t}}),r("unification/actions/OpenProfile",["require","exports","module","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"OPEN_PROFILE"},i.apply(this,arguments)}n.exports=o;var i=t("./BaseRpcAction");o.prototype=Object.create(i.prototype),o.prototype.extractData=function(){return{userId:this.options.open_profile}}}),r("unification/actions/OpenUrl",["require","exports","module","common/utils","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"OPEN_URL"},r.apply(this,arguments)}n.exports=o;var i=t("common/utils"),r=t("./BaseRpcAction");o.prototype=Object.create(r.prototype),o.prototype.extractData=function(){var t=i.decodeHtml(this.options.open_url.tco);return window.open(t),{url:t}}}),r("unification/actions/RetweetStatus",["require","exports","module","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"RETWEET_STATUS"},i.apply(this,arguments)}n.exports=o;var i=t("./BaseRpcAction");o.prototype=Object.create(i.prototype),o.prototype.extractData=function(){return{}}}),r("unification/actions/ShareStatus",["require","exports","module","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"SHARE_STATUS"},i.apply(this,arguments)}n.exports=o;var i=t("./BaseRpcAction");o.prototype=Object.create(i.prototype)}),r("unification/actions/FollowUser",["require","exports","module","common/utils","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"FOLLOW_USER",user_id:""},r.apply(this,arguments)}n.exports=o;var i=t("common/utils"),r=t("./BaseRpcAction");o.prototype=Object.create(r.prototype),o.prototype.newActionHandler=function(){var t=i.getFollowElements(this.getTriggeredDomEvent());t.forEach(function(t){t.classList.remove("not-following"),t.classList.add("following")}),r.prototype.newActionHandler.call(this)},o.prototype.extractData=function(){return{userId:this.options.user_id}}}),r("unification/actions/UnfollowUser",["require","exports","module","common/utils","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"UNFOLLOW_USER",user_id:""},r.apply(this,arguments)}n.exports=o;var i=t("common/utils"),r=t("./BaseRpcAction");o.prototype=Object.create(r.prototype),o.prototype.newActionHandler=function(){var t=i.getFollowElements(this.getTriggeredDomEvent());t.forEach(function(t){t.classList.remove("following"),t.classList.add("not-following")}),r.prototype.newActionHandler.call(this)},o.prototype.extractData=function(){return{userId:this.options.user_id}}}),r("unification/actions/UnblockUser",["require","exports","module","common/utils","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"UNBLOCK_USER",user_id:""},r.apply(this,arguments)}n.exports=o;var i=t("common/utils"),r=t("./BaseRpcAction");o.prototype=Object.create(r.prototype),o.prototype.newActionHandler=function(){var t=i.getFollowElements(this.getTriggeredDomEvent);t.forEach(function(t){t.classList.remove("blocked"),t.classList.add("not-following")}),r.prototype.newActionHandler.call(this)},o.prototype.extractData=function(){return{userId:this.options.user_id}}}),r("unification/actions/CancelFollowUser",["require","exports","module","common/utils","./BaseRpcAction"],function(t,e,n){function o(){this.schema={id:"",action_type:"CANCEL_FOLLOW_USER",user_id:""},r.apply(this,arguments)}n.exports=o;var i=t("common/utils"),r=t("./BaseRpcAction");o.prototype=Object.create(r.prototype),o.prototype.newActionHandler=function(){var t=i.getFollowElements(this.getTriggeredDomEvent);t.forEach(function(t){t.classList.remove("pending"),t.classList.add("not-following")}),r.prototype.newActionHandler.call(this)},o.prototype.extractData=function(){return{userId:this.options.user_id}}}),r("unification/actions/main",["require","exports","module","./ApiRequest","./ApplyStyles","./RemoveStyles","./ComposeStatus","./FavoriteStatus","./OpenPhoto","./OpenProfile","./OpenUrl","./RetweetStatus","./ShareStatus","./FollowUser","./UnfollowUser","./UnblockUser","./CancelFollowUser"],function(t,e,n){n.exports={API_REQUEST:t("./ApiRequest"),APPLY_STYLES:t("./ApplyStyles"),REMOVE_STYLES:t("./RemoveStyles"),COMPOSE_STATUS:t("./ComposeStatus"),FAVORITE_STATUS:t("./FavoriteStatus"),OPEN_PHOTO:t("./OpenPhoto"),OPEN_PROFILE:t("./OpenProfile"),OPEN_URL:t("./OpenUrl"),RETWEET_STATUS:t("./RetweetStatus"),SHARE_STATUS:t("./ShareStatus"),FOLLOW_USER:t("./FollowUser"),UNFOLLOW_USER:t("./UnfollowUser"),UNBLOCK_USER:t("./UnblockUser"),CANCEL_FOLLOW_USER:t("./CancelFollowUser")}}),r("unification/actions/registry",["require","exports","module","delegate","unification/config","./main","./handlers","unification/logger"],function(t,e,n){function o(t,e){try{t.forEach(function(t){i(t,e)}),a(),s()}catch(n){console.error(n.message)}}function i(t,e){try{f.registry[t.id]=c(t,e)}catch(n){m(n.message)}}function r(){return f.registry}function a(){var t=Object.keys(g);t.forEach(function(t){if("load"!==t){var e=g[t],n=y.resolveSelector(e);l.on(t,n,u),m(["Attaching",t,"to all nodes with",n].join(" "))}})}function s(){var t,e,n=g.load,o=y.resolveSelector(n),i=document.querySelector(o);return i?(t=y.getActionId(n,i),e=f.registry[t],void("complete"===document.readyState||"interactive"===document.readyState?(e.performAction(),m(["Firing load with action",t].join(" "))):(document.addEventListener("DOMContentLoaded",function(){e.performAction(),m(["Firing load with action",t].join(" "))}),m(["Attaching load with action",t].join(" "))))):void m("No element with onload. Not performing attachLoadEvent")}function c(t,e){var n=d[t.action_type];if(!n)throw new Error(["Action",t.action_type,"not supported"].join(" "));return new n(t,e)}function u(t){var e=g[t.type],n=y.getActionId(e,t.delegateTarget);f.performActionWithId(n,t),t.preventDefault(),m(["Triggered action",n,"by",t.type,"on"].join(" "),t.delegateTarget)}n.exports={registerActions:o,registerAction:i,getRegisteredActions:r};var l=t("delegate")(document),p=t("unification/config"),d=t("./main"),f=t("./handlers"),h=t("unification/logger"),m=h("[REGISTER ACTIONS]"),g=p.eventToTcmlActionAttr,y={resolveWebActionAttributeName:function(t){return"data-"+t},resolveSelector:function(t){return"*["+y.resolveWebActionAttributeName(t)+"]"},getActionId:function(t,e){var n=y.resolveWebActionAttributeName(t),o=e.getAttribute(n);return o}}}),"undefined"==typeof window.__karma__&&r("unification/layout/player",["require","exports","module"],function(t,e,o){o.exports={resizePlayers:n}}),o.config({baseUrl:"/lib/js",paths:{ajax:"./unification/ajax",delegate:"../bower_components/delegate.js/delegate",matches:"../bower_components/matches.js/matches",throttle:"./common/throttle",xdm:"../bower_components/xdm.js/xdm"}}),i(["common/utils","common/video-interface-manager","unification/actions/registry","unification/bindings/registry","unification/bridge","unification/layout/player"],function(t,e,n,o,i,r){function a(){var a=t.getConfigFromJsonIn("bindings-config"),c=t.getConfigFromJsonIn("action-config");window.bindings={BINDINGS:a},document.addEventListener("DOMContentLoaded",r.resizePlayers),document.addEventListener("onreadystatechange",r.resizePlayers),document.addEventListener("load",r.resizePlayers),r.resizePlayers(),i.initAndResizeHost(),o.init(window.bindings),c=c.concat(s()),n.registerActions(c),e.isSupported()&&e.init(i)}function s(){var e=[],n=document.querySelectorAll("div[data-user-id]");return t.toArray(n).forEach(function(t){[{sel:".follow-text",action_type:"FOLLOW_USER"},{sel:".unfollow-text",action_type:"UNFOLLOW_USER"},{sel:".unblock-text",action_type:"UNBLOCK_USER"},{sel:".cancel-req-text",action_type:"CANCEL_FOLLOW_USER"}].forEach(function(n){e.push({id:t.querySelector(n.sel).dataset.tap_action_id,action_type:n.action_type,user_id:t.dataset.userId})})}),e}a()}),r("main-unification",function(){})}();